-- Table principale Projet
CREATE TABLE Projet (
    id SERIAL PRIMARY KEY,
    nom VARCHAR(255) NOT NULL,
    code INT NOT NULL UNIQUE,
    description TEXT,
    annee_debut INT,
    annee_fin INT,
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    impact_attendu TEXT
);


--Table Statut
CREATE TABLE Statut (
    id INT PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    statut_actuel VARCHAR(100) NOT NULL,
    date_mise_a_jour TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--Table Type
CREATE TABLE Type (
    id INT PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    type VARCHAR(100) NOT NULL,
    date_mise_a_jour TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


--Table objectifs
CREATE TABLE Objectifs (
    id SERIAL PRIMARY KEY,
    projet_id INT REFERENCES Projet(id) ON DELETE CASCADE,
    description TEXT NOT NULL,
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--Table priorite
CREATE TABLE Priorite (
    id SERIAL PRIMARY KEY,
    projet_id INT REFERENCES Projet(id) ON DELETE CASCADE,
    description TEXT NOT NULL,
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


--Table Minist√®re
CREATE TABLE Ministere(
    id SERIAL PRIMARY KEY,
    proejt_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    nom VARCHAR(100) NOT NULL,
    code INT NOT NULL UNIQUE
)

--Table Source de financement
CREATE TABLE source_financement(
    id SERIAL PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    nom VARCHAR(255),
    code INT NOT NULL UNIQUE
)


--Table User
CREATE TABLE User(
    id SERIAL PRIMARY KEY,
    nom VARCHAR(255),
    prenom VARCHAR(255),
    email VARCHAR(255) NOT NULL UNIQUE,
    mdp VARCHAR(255)
)

--TABLE Role
CREATE TABLE Role(
    id SERIAL PRIMARY KEY,
    nom VARCHAR (255) NOT NULL UNIQUE,
    code VARCHAR(255)
)

-- Table de liaison RoleUser
CREATE TABLE RoleUser (
    user_id INT REFERENCES User(id) ON DELETE CASCADE,
    role_id INT REFERENCES Role(id) ON DELETE CASCADE,
    PRIMARY KEY (user_id, role_id)
);


-- Table Categorie
CREATE TABLE Categorie (
    id SERIAL PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    nom VARCHAR(255) NOT NULL UNIQUE
);


-- Table Ville
CREATE TABLE Ville (
    id SERIAL PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    nom VARCHAR(255) NOT NULL UNIQUE
);


-- Table InfrastructureMobilisee
CREATE TABLE InfrastructureMobilisee (
    id SERIAL PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    nom VARCHAR(255) NOT NULL UNIQUE,
    date_mise_a_jour TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


-- Table FondsDecaisse
CREATE TABLE FondsDecaisse (
    id SERIAL PRIMARY KEY,
    projet_id INT REFERENCES Projet(id) ON DELETE CASCADE,
    montant NUMERIC(15, 2) NOT NULL,
    date_mise_a_jour TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Table Risque
CREATE TABLE Risque (
    id SERIAL PRIMARY KEY,
    projet_id INT UNIQUE REFERENCES Projet(id) ON DELETE CASCADE,
    description TEXT NOT NULL
);


-- Table Commentaire
CREATE TABLE Commentaire (
    id SERIAL PRIMARY KEY,
    projet_id INT REFERENCES Projet(id) ON DELETE CASCADE,
    contenu TEXT NOT NULL,
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
